{{/*
  Textarea Component

  Multi-line text input with consistent styling.

  Params:
    name        - Textarea name attribute (required)
    id          - Textarea ID (defaults to name if not provided)
    value       - Textarea content
    placeholder - Placeholder text
    rows        - Number of visible text lines (default: 3)
    required    - Boolean, marks field as required
    disabled    - Boolean, disables the textarea
    readonly    - Boolean, makes textarea read-only
    invalid     - Boolean, shows invalid state (red border)
    resizable   - Boolean, allows vertical resizing (default: true)
    autofocus   - Boolean, focuses textarea on page load
    minlength   - Minimum length
    maxlength   - Maximum length
    class       - Additional CSS classes for the wrapper
    textareaClass - Additional CSS classes for the textarea element
    ariaDescribedby - ID of element describing this textarea (for errors)

    htmx attributes:
    hxGet, hxPost, hxTrigger, hxTarget, hxSwap

  Usage:
    {{template "textarea" dict "name" "message" "placeholder" "Enter your message..." "rows" 5}}
    {{template "textarea" dict "name" "notes" "value" .ExistingNotes "resizable" false}}
*/}}

{{define "textarea"}}
{{- $id := or .id .name -}}
{{- $rows := or .rows 3 -}}
{{- $resizable := true -}}
{{- if isset . "resizable" -}}
  {{- $resizable = .resizable -}}
{{- end -}}
{{- $invalid := or .invalid false -}}
{{- $disabled := or .disabled false -}}

<span data-slot="control"
      class="relative block w-full before:absolute before:inset-px before:rounded-[calc(var(--radius-lg)-1px)] before:bg-white before:shadow-sm after:pointer-events-none after:absolute after:inset-0 after:rounded-lg after:ring-transparent after:ring-inset focus-within:after:ring-2 focus-within:after:ring-[var(--color-primary)] {{if $disabled}}opacity-50 before:bg-[var(--color-zinc-950-5)] before:shadow-none{{end}} {{.class}}">
  <textarea name="{{.name}}"
            id="{{$id}}"
            rows="{{$rows}}"
            {{if .placeholder}}placeholder="{{.placeholder}}"{{end}}
            {{if .required}}required{{end}}
            {{if $disabled}}disabled{{end}}
            {{if .readonly}}readonly{{end}}
            {{if .autofocus}}autofocus{{end}}
            {{if .minlength}}minlength="{{.minlength}}"{{end}}
            {{if .maxlength}}maxlength="{{.maxlength}}"{{end}}
            {{if .ariaDescribedby}}aria-describedby="{{.ariaDescribedby}}"{{end}}
            {{if $invalid}}aria-invalid="true"{{end}}
            {{if .hxGet}}hx-get="{{.hxGet}}"{{end}}
            {{if .hxPost}}hx-post="{{.hxPost}}"{{end}}
            {{if .hxTrigger}}hx-trigger="{{.hxTrigger}}"{{end}}
            {{if .hxTarget}}hx-target="{{.hxTarget}}"{{end}}
            {{if .hxSwap}}hx-swap="{{.hxSwap}}"{{end}}
            class="relative block h-full w-full appearance-none rounded-lg px-3.5 py-2.5 sm:px-3 sm:py-1.5 text-base/6 text-[var(--color-text)] placeholder:text-[var(--color-text-tertiary)] sm:text-sm/6 border bg-transparent focus:outline-none {{if $resizable}}resize-y{{else}}resize-none{{end}} {{if $invalid}}border-[var(--color-danger)] hover:border-[var(--color-danger)]{{else}}border-[var(--color-border)] hover:border-[var(--color-border-hover)]{{end}} {{if $disabled}}border-[var(--color-border-strong)] cursor-not-allowed{{end}} {{.textareaClass}}">{{.value}}</textarea>
</span>
{{end}}
