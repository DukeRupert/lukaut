{{/*
  Dialog Component

  Modal dialog using Alpine.js for interactivity.
  Includes backdrop, focus trapping, and escape key handling.

  Components:
    - dialog: Full dialog with x-data (can be triggered externally)
    - dialog-backdrop: Semi-transparent overlay
    - dialog-panel: The dialog content container
    - dialog-title: Dialog heading
    - dialog-description: Dialog description text
    - dialog-body: Main content area
    - dialog-actions: Footer with action buttons

  Params for dialog:
    id      - Dialog ID for external triggering (required)
    size    - Panel width: xs, sm, md, lg (default), xl, 2xl, 3xl, 4xl, 5xl
    class   - Additional CSS classes

  Usage (inline trigger):
    <div x-data="{ dialogOpen: false }">
      <button @click="dialogOpen = true">Open Dialog</button>

      {{template "dialog-start" dict "id" "my-dialog" "size" "md"}}
        {{template "dialog-title" dict "text" "Confirm Action"}}
        {{template "dialog-description" dict "text" "Are you sure you want to proceed?"}}

        {{template "dialog-body-start"}}
          <p>Additional content here...</p>
        {{template "dialog-body-end"}}

        {{template "dialog-actions-start"}}
          {{template "button" dict "text" "Cancel" "variant" "plain" "onclick" "$dispatch('close-dialog')"}}
          {{template "button" dict "text" "Confirm" "color" "primary"}}
        {{template "dialog-actions-end"}}
      {{template "dialog-end"}}
    </div>

  Usage (external trigger via Alpine store or event):
    {{template "dialog-standalone-start" dict "id" "confirm-delete" "size" "sm"}}
      {{template "dialog-title" dict "text" "Delete Item"}}
      {{template "dialog-description" dict "text" "This action cannot be undone."}}
      {{template "dialog-actions-start"}}
        {{template "button" dict "text" "Cancel" "variant" "plain" "onclick" "$dispatch('close-dialog')"}}
        {{template "button" dict "text" "Delete" "color" "danger"}}
      {{template "dialog-actions-end"}}
    {{template "dialog-end"}}

    <button @click="$dispatch('open-dialog', 'confirm-delete')">Delete</button>
*/}}

{{/*
  Dialog Start (assumes parent has x-data with open state)

  Use when dialog is inside a component that manages its own state.
  Parent must have: x-data="{ dialogOpen: false }"
*/}}
{{define "dialog-start"}}
{{- $size := or .size "lg" -}}
<div x-show="dialogOpen"
     x-cloak
     class="relative z-50 {{.class}}"
     role="dialog"
     aria-modal="true"
     @keydown.escape.window="dialogOpen = false">

  {{/* Backdrop */}}
  <div x-show="dialogOpen"
       x-transition:enter="transition ease-out duration-100"
       x-transition:enter-start="opacity-0"
       x-transition:enter-end="opacity-100"
       x-transition:leave="transition ease-in duration-100"
       x-transition:leave-start="opacity-100"
       x-transition:leave-end="opacity-0"
       class="fixed inset-0 bg-[var(--color-zinc-950)]/25 backdrop-blur-sm"
       @click="dialogOpen = false">
  </div>

  {{/* Panel container */}}
  <div class="fixed inset-0 w-screen overflow-y-auto">
    <div class="grid min-h-full grid-rows-[1fr_auto] justify-items-center sm:grid-rows-[1fr_auto_3fr] sm:p-4">
      <div x-show="dialogOpen"
           x-transition:enter="transition ease-out duration-100"
           x-transition:enter-start="opacity-0 translate-y-12 sm:translate-y-0 sm:scale-95"
           x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
           x-transition:leave="transition ease-in duration-100"
           x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
           x-transition:leave-end="opacity-0 translate-y-12 sm:translate-y-0 sm:scale-95"
           @close-dialog.window="dialogOpen = false"
           class="row-start-2 w-full min-w-0 rounded-t-3xl bg-white p-8 shadow-lg ring-1 ring-[var(--color-zinc-950)]/10 sm:mb-auto sm:rounded-2xl
                  {{if eq $size "xs"}}sm:max-w-xs{{end}}
                  {{if eq $size "sm"}}sm:max-w-sm{{end}}
                  {{if eq $size "md"}}sm:max-w-md{{end}}
                  {{if eq $size "lg"}}sm:max-w-lg{{end}}
                  {{if eq $size "xl"}}sm:max-w-xl{{end}}
                  {{if eq $size "2xl"}}sm:max-w-2xl{{end}}
                  {{if eq $size "3xl"}}sm:max-w-3xl{{end}}
                  {{if eq $size "4xl"}}sm:max-w-4xl{{end}}
                  {{if eq $size "5xl"}}sm:max-w-5xl{{end}}">
{{end}}

{{define "dialog-end"}}
      </div>
    </div>
  </div>
</div>
{{end}}

{{/*
  Dialog Standalone Start

  Self-contained dialog with its own Alpine.js state.
  Can be opened via: $dispatch('open-dialog', 'dialog-id')
  Can be closed via: $dispatch('close-dialog') or escape key

  Params:
    id    - Unique ID for this dialog (required)
    size  - Panel width: xs, sm, md, lg (default), xl, 2xl, 3xl, 4xl, 5xl
    class - Additional CSS classes
*/}}
{{define "dialog-standalone-start"}}
{{- $size := or .size "lg" -}}
<div x-data="{ open: false }"
     x-show="open"
     x-cloak
     @open-dialog.window="if ($event.detail === '{{.id}}') open = true"
     @close-dialog.window="open = false"
     @keydown.escape.window="open = false"
     class="relative z-50 {{.class}}"
     role="dialog"
     aria-modal="true"
     id="{{.id}}">

  {{/* Backdrop */}}
  <div x-show="open"
       x-transition:enter="transition ease-out duration-100"
       x-transition:enter-start="opacity-0"
       x-transition:enter-end="opacity-100"
       x-transition:leave="transition ease-in duration-100"
       x-transition:leave-start="opacity-100"
       x-transition:leave-end="opacity-0"
       class="fixed inset-0 bg-[var(--color-zinc-950)]/25 backdrop-blur-sm"
       @click="open = false">
  </div>

  {{/* Panel container */}}
  <div class="fixed inset-0 w-screen overflow-y-auto">
    <div class="grid min-h-full grid-rows-[1fr_auto] justify-items-center sm:grid-rows-[1fr_auto_3fr] sm:p-4">
      <div x-show="open"
           x-transition:enter="transition ease-out duration-100"
           x-transition:enter-start="opacity-0 translate-y-12 sm:translate-y-0 sm:scale-95"
           x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
           x-transition:leave="transition ease-in duration-100"
           x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
           x-transition:leave-end="opacity-0 translate-y-12 sm:translate-y-0 sm:scale-95"
           class="row-start-2 w-full min-w-0 rounded-t-3xl bg-white p-8 shadow-lg ring-1 ring-[var(--color-zinc-950)]/10 sm:mb-auto sm:rounded-2xl
                  {{if eq $size "xs"}}sm:max-w-xs{{end}}
                  {{if eq $size "sm"}}sm:max-w-sm{{end}}
                  {{if eq $size "md"}}sm:max-w-md{{end}}
                  {{if eq $size "lg"}}sm:max-w-lg{{end}}
                  {{if eq $size "xl"}}sm:max-w-xl{{end}}
                  {{if eq $size "2xl"}}sm:max-w-2xl{{end}}
                  {{if eq $size "3xl"}}sm:max-w-3xl{{end}}
                  {{if eq $size "4xl"}}sm:max-w-4xl{{end}}
                  {{if eq $size "5xl"}}sm:max-w-5xl{{end}}">
{{end}}

{{/*
  Dialog Title

  Main heading for the dialog.

  Params:
    text  - Title text
    class - Additional CSS classes
*/}}
{{define "dialog-title"}}
<h2 class="text-lg/6 font-semibold text-balance text-[var(--color-text)] sm:text-base/6 {{.class}}">
  {{.text}}
</h2>
{{end}}

{{/*
  Dialog Description

  Descriptive text below the title.

  Params:
    text  - Description text
    class - Additional CSS classes
*/}}
{{define "dialog-description"}}
<p class="mt-2 text-base/6 text-[var(--color-text-secondary)] text-pretty sm:text-sm/6 {{.class}}">
  {{.text}}
</p>
{{end}}

{{/*
  Dialog Body

  Main content area for forms, lists, or other content.

  Usage:
    {{template "dialog-body-start"}}
      <form>...</form>
    {{template "dialog-body-end"}}
*/}}
{{define "dialog-body-start"}}
<div class="mt-6 {{.class}}">
{{end}}

{{define "dialog-body-end"}}
</div>
{{end}}

{{/*
  Dialog Actions

  Footer area for action buttons.
  Buttons stack vertically on mobile, horizontal on desktop.

  Usage:
    {{template "dialog-actions-start"}}
      {{template "button" dict "text" "Cancel" "variant" "plain" "onclick" "$dispatch('close-dialog')"}}
      {{template "button" dict "text" "Save" "color" "primary"}}
    {{template "dialog-actions-end"}}
*/}}
{{define "dialog-actions-start"}}
<div class="mt-8 flex flex-col-reverse items-center justify-end gap-3 *:w-full sm:flex-row sm:*:w-auto {{.class}}">
{{end}}

{{define "dialog-actions-end"}}
</div>
{{end}}

{{/*
  Dialog Close Button

  X button in the top-right corner to close the dialog.
  Optional - add inside dialog-start if desired.

  Usage:
    {{template "dialog-start" dict "id" "my-dialog"}}
      {{template "dialog-close-button"}}
      {{template "dialog-title" dict "text" "My Dialog"}}
      ...
*/}}
{{define "dialog-close-button"}}
<button type="button"
        @click="dialogOpen = false; $dispatch('close-dialog')"
        class="absolute top-4 right-4 p-2 text-[var(--color-text-tertiary)] hover:text-[var(--color-text)] rounded-lg hover:bg-[var(--color-zinc-100)] focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]">
  <span class="sr-only">Close</span>
  <svg class="size-5" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
    <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
  </svg>
</button>
{{end}}
