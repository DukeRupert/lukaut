{{/*
  Sidebar Layout Component

  Full-page layout with sidebar navigation and mobile-responsive behavior.
  Uses Alpine.js for mobile menu toggle.

  Features:
  - Fixed sidebar on desktop (lg+)
  - Slide-out drawer on mobile
  - Mobile header with hamburger menu
  - Main content area with proper spacing

  Components:
    - sidebar-layout: Full layout wrapper with Alpine.js state
    - sidebar-layout-sidebar: Where to place sidebar content
    - sidebar-layout-navbar: Mobile navbar content
    - sidebar-layout-main: Main content area

  Usage:
    {{template "sidebar-layout-start"}}
      {{/* Desktop sidebar */}}
      {{template "sidebar-layout-sidebar-start"}}
        {{template "sidebar-start"}}
          {{template "sidebar-header-start"}}
            <a href="/" class="flex items-center gap-2">
              <img src="/logo.svg" class="h-8">
              <span class="font-semibold">Lukaut</span>
            </a>
          {{template "sidebar-header-end"}}

          {{template "sidebar-body-start"}}
            {{template "sidebar-section-start"}}
              {{template "sidebar-item" dict "href" "/dashboard" "icon" "home" "text" "Dashboard"}}
            {{template "sidebar-section-end"}}
          {{template "sidebar-body-end"}}
        {{template "sidebar-end"}}
      {{template "sidebar-layout-sidebar-end"}}

      {{/* Mobile navbar */}}
      {{template "sidebar-layout-navbar-start"}}
        {{template "navbar-start"}}
          {{template "navbar-spacer"}}
          {{template "navbar-section-start"}}
            {{template "navbar-item" dict "href" "/account" "icon" "user-circle"}}
          {{template "navbar-section-end"}}
        {{template "navbar-end"}}
      {{template "sidebar-layout-navbar-end"}}

      {{/* Main content */}}
      {{template "sidebar-layout-main-start"}}
        <h1>Page content here</h1>
      {{template "sidebar-layout-main-end"}}
    {{template "sidebar-layout-end"}}
*/}}

{{define "sidebar-layout-start"}}
<div x-data="{ showMobileSidebar: false }"
     @keydown.escape.window="showMobileSidebar = false"
     class="relative isolate flex min-h-svh w-full bg-white max-lg:flex-col lg:bg-[var(--color-zinc-100)] {{.class}}">
{{end}}

{{define "sidebar-layout-end"}}
</div>
{{end}}

{{/*
  Sidebar Layout Sidebar

  Container for the sidebar. Fixed on desktop, slide-out drawer on mobile.
*/}}
{{define "sidebar-layout-sidebar-start"}}
  {{/* Desktop sidebar - fixed */}}
  <div class="fixed inset-y-0 left-0 w-64 max-lg:hidden">
{{end}}

{{define "sidebar-layout-sidebar-end"}}
  </div>

  {{/* Mobile sidebar - slide-out drawer */}}
  <div x-show="showMobileSidebar"
       x-cloak
       class="relative z-50 lg:hidden"
       role="dialog"
       aria-modal="true">
    {{/* Backdrop */}}
    <div x-show="showMobileSidebar"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         class="fixed inset-0 bg-black/30"
         @click="showMobileSidebar = false">
    </div>

    {{/* Panel */}}
    <div x-show="showMobileSidebar"
         x-transition:enter="transition ease-in-out duration-300 transform"
         x-transition:enter-start="-translate-x-full"
         x-transition:enter-end="translate-x-0"
         x-transition:leave="transition ease-in-out duration-300 transform"
         x-transition:leave-start="translate-x-0"
         x-transition:leave-end="-translate-x-full"
         class="fixed inset-y-0 left-0 w-full max-w-80 p-2">
      <div class="flex h-full flex-col rounded-lg bg-white shadow-sm ring-1 ring-[var(--color-zinc-950)]/5">
        {{/* Close button */}}
        <div class="-mb-3 px-4 pt-3">
          <button type="button"
                  @click="showMobileSidebar = false"
                  class="rounded-lg p-2 text-[var(--color-text-secondary)] hover:bg-[var(--color-zinc-950)]/5 hover:text-[var(--color-text)]"
                  aria-label="Close navigation">
            <svg class="size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        {{/* Re-render sidebar content for mobile */}}
        <div x-ref="mobileSidebarContent"></div>
      </div>
    </div>
  </div>
{{end}}

{{/*
  Sidebar Layout Navbar

  Mobile-only navbar that appears above the main content.
  Includes hamburger menu button.
*/}}
{{define "sidebar-layout-navbar-start"}}
<header class="flex items-center px-4 lg:hidden">
  {{/* Hamburger menu button */}}
  <div class="py-2.5">
    <button type="button"
            @click="showMobileSidebar = true"
            class="rounded-lg p-2 text-[var(--color-text-secondary)] hover:bg-[var(--color-zinc-950)]/5 hover:text-[var(--color-text)]"
            aria-label="Open navigation">
      <svg class="size-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"/>
      </svg>
    </button>
  </div>
  {{/* Navbar content */}}
  <div class="min-w-0 flex-1">
{{end}}

{{define "sidebar-layout-navbar-end"}}
  </div>
</header>
{{end}}

{{/*
  Sidebar Layout Main

  Main content area with proper spacing for the fixed sidebar.
*/}}
{{define "sidebar-layout-main-start"}}
<main class="flex flex-1 flex-col pb-2 lg:min-w-0 lg:pt-2 lg:pr-2 lg:pl-64">
  <div class="grow p-6 lg:rounded-lg lg:bg-white lg:p-10 lg:shadow-sm lg:ring-1 lg:ring-[var(--color-zinc-950)]/5">
    <div class="mx-auto max-w-6xl">
{{end}}

{{define "sidebar-layout-main-end"}}
    </div>
  </div>
</main>
{{end}}

{{/*
  Simple App Shell

  A simpler full-page layout without mobile sidebar drawer.
  Good for simpler apps or when you want custom mobile navigation.

  Usage:
    {{template "app-shell-start"}}
      {{template "app-shell-sidebar-start"}}
        ... sidebar content ...
      {{template "app-shell-sidebar-end"}}

      {{template "app-shell-main-start"}}
        ... main content ...
      {{template "app-shell-main-end"}}
    {{template "app-shell-end"}}
*/}}
{{define "app-shell-start"}}
<div class="flex min-h-svh {{.class}}">
{{end}}

{{define "app-shell-end"}}
</div>
{{end}}

{{define "app-shell-sidebar-start"}}
<aside class="hidden w-64 flex-shrink-0 border-r border-[var(--color-zinc-950)]/5 bg-white lg:block {{.class}}">
{{end}}

{{define "app-shell-sidebar-end"}}
</aside>
{{end}}

{{define "app-shell-main-start"}}
<main class="flex-1 overflow-auto {{.class}}">
  <div class="mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8">
{{end}}

{{define "app-shell-main-end"}}
  </div>
</main>
{{end}}
