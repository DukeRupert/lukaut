{{define "login_form"}}
<form id="login-form" class="space-y-6" action="/login" method="POST"
      hx-post="/login"
      hx-swap="outerHTML"
      hx-target="#login-form">
    {{if .CSRFToken}}{{csrfField .CSRFToken}}{{end}}
    {{if .ReturnTo}}<input type="hidden" name="return_to" value="{{.ReturnTo}}">{{end}}

    {{/* Flash message inside form for htmx swaps */}}
    {{if .Flash}}
    <div class="rounded-md p-4 {{if eq .Flash.Type "error"}}bg-red-50{{else if eq .Flash.Type "success"}}bg-green-50{{else}}bg-blue-50{{end}}">
        <div class="flex">
            <div class="flex-shrink-0">
                {{if eq .Flash.Type "error"}}
                <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z" clip-rule="evenodd" />
                </svg>
                {{else if eq .Flash.Type "success"}}
                <svg class="h-5 w-5 text-green-400" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
                </svg>
                {{else}}
                <svg class="h-5 w-5 text-blue-400" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z" clip-rule="evenodd" />
                </svg>
                {{end}}
            </div>
            <div class="ml-3">
                <p class="text-sm font-medium {{if eq .Flash.Type "error"}}text-red-800{{else if eq .Flash.Type "success"}}text-green-800{{else}}text-blue-800{{end}}">
                    {{.Flash.Message}}
                </p>
            </div>
        </div>
    </div>
    {{end}}

    {{/* Email field */}}
    <div data-slot="field">
        <label for="email" data-slot="label" class="block text-sm/6 font-medium text-[var(--color-text)]">
            Email address
        </label>
        <div class="mt-2">
            <span class="relative block">
                <input type="email"
                       name="email"
                       id="email"
                       autocomplete="email"
                       required
                       value="{{.Form.Email}}"
                       class="block w-full rounded-lg border-none bg-white py-2.5 px-3.5 text-base/6 text-[var(--color-text)] sm:py-1.5 sm:px-3 sm:text-sm/6
                              shadow-sm ring-1 ring-inset ring-[var(--color-zinc-950)]/10
                              placeholder:text-[var(--color-text-tertiary)]
                              focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]
                              {{if .Errors.email}}ring-[var(--color-danger)] focus:ring-[var(--color-danger)]{{end}}">
            </span>
        </div>
        {{if .Errors.email}}
        <p data-slot="error" class="mt-2 text-sm/6 text-[var(--color-danger)]" role="alert">{{.Errors.email}}</p>
        {{end}}
    </div>

    {{/* Password field */}}
    <div data-slot="field">
        <label for="password" data-slot="label" class="block text-sm/6 font-medium text-[var(--color-text)]">
            Password
        </label>
        <div class="mt-2">
            <span class="relative block">
                <input type="password"
                       name="password"
                       id="password"
                       autocomplete="current-password"
                       required
                       class="block w-full rounded-lg border-none bg-white py-2.5 px-3.5 text-base/6 text-[var(--color-text)] sm:py-1.5 sm:px-3 sm:text-sm/6
                              shadow-sm ring-1 ring-inset ring-[var(--color-zinc-950)]/10
                              placeholder:text-[var(--color-text-tertiary)]
                              focus:outline-none focus:ring-2 focus:ring-[var(--color-primary)]
                              {{if .Errors.password}}ring-[var(--color-danger)] focus:ring-[var(--color-danger)]{{end}}">
            </span>
        </div>
        {{if .Errors.password}}
        <p data-slot="error" class="mt-2 text-sm/6 text-[var(--color-danger)]" role="alert">{{.Errors.password}}</p>
        {{end}}
    </div>

    {{/* Remember me & Forgot password */}}
    <div class="flex items-center justify-between">
        <div class="grid grid-cols-[1.125rem_1fr] gap-x-3 sm:grid-cols-[1rem_1fr]">
            <span class="group inline-flex">
                <input type="checkbox"
                       id="remember-me"
                       name="remember-me"
                       class="peer sr-only">
                <span class="relative isolate flex size-[1.125rem] sm:size-4 items-center justify-center rounded-[0.3125rem] cursor-pointer
                             before:absolute before:inset-0 before:-z-10 before:rounded-[calc(0.3125rem-1px)] before:bg-white before:shadow-sm
                             border border-[var(--color-zinc-950)]/15 hover:border-[var(--color-zinc-950)]/30
                             peer-checked:border-transparent peer-checked:before:bg-[var(--color-primary)] peer-checked:bg-[var(--color-primary-hover)]
                             peer-focus:outline-2 peer-focus:outline-offset-2 peer-focus:outline-[var(--color-primary)]">
                    <svg class="size-4 sm:size-3.5 stroke-white opacity-0 peer-checked:group-[]:opacity-100"
                         viewBox="0 0 14 14" fill="none">
                        <path d="M3 8L6 11L11 3.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </span>
            </span>
            <label for="remember-me" class="text-sm/6 text-[var(--color-text)]">Remember me</label>
        </div>

        <div class="text-sm/6">
            <a href="/forgot-password" class="font-semibold text-[var(--color-primary)] hover:text-[var(--color-primary-hover)]">
                Forgot password?
            </a>
        </div>
    </div>

    {{/* Submit button */}}
    <div>
        <button type="submit"
                class="flex w-full justify-center rounded-lg px-3.5 py-2.5 sm:px-3 sm:py-1.5 text-base/6 sm:text-sm/6 font-semibold
                       bg-[var(--color-primary)] text-white shadow-sm
                       hover:bg-[var(--color-primary-hover)]
                       focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-[var(--color-primary)]
                       transition-colors">
            Sign in
        </button>
    </div>
</form>
{{end}}
